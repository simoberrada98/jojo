# Merchant Feed Keys

This document outlines the supported keys and expected value formats for the Google Merchant feed generated by `app/feeds/merchant/route.ts`.

The feed uses RSS `item` elements combined with Google namespace attributes (`g:`). Standard RSS elements (`title`, `link`, `description`) are included alongside the following Google attributes:

- g:id — string (required)
- g:product_type — string (required)
- g:google_product_category — string (required; Google taxonomy path or ID)
- g:brand — string (required)
- g:condition — enum (required; one of `new`, `used`, `refurbished`)
- g:gtin — string (optional)
- g:price — currency (required; format `0.00 USD`)
- g:sale_price — currency (optional; format `0.00 USD`)
- g:availability — enum (required; `in stock` or `out of stock`)
- g:image_link — URL (required)
- g:link — URL (required)
- g:identifier_exists — boolean (required; `true` when GTIN present, else `false`)
- g:shipping — composite (optional; includes `country`, `service`, `price`)
- g:updated_time — date string (optional; UTC)

Custom, backward-compatible review attributes (non-standard) may be present:

- g:product_review_average — number (optional)
- g:product_review_count — number (optional)
- g:product_review_snippet — CDATA string (optional; short comment)
- g:product_review_source_link — URL (optional)

Notes:

- Currency formatting uses two decimals followed by a space and currency code (e.g., `123.45 USD`).
- Availability is derived from stock quantity (`>0` → `in stock`, otherwise `out of stock`).
- Descriptions are sanitized to remove HTML and truncated to 5000 characters before being wrapped in CDATA.
- When `gtin` is missing, `g:identifier_exists` must be `false`.
- For image links, a product image is preferred; fallback is the site favicon.

For implementation details and light runtime validation, see `lib/feeds/merchant/schema.ts`.

